{% extends "base.html" %}
{% block title %}Results{% endblock %}
{% block content %}

<style type="text/css">
@media screen and (max-width: 767px) {
    .sidebar-offcanvas {
        display: none;
    }
    #options {
        display: none;
        right: 0;
    }
}

#options {
    background-color: white;
}

.scroll-lock {
    overflow: hidden;
}

body {
    overflow-x: hidden;
}
</style>

<div class="navbar navbar-default navbar-fixed-top" style="top: 50px; z-index: 1029; border: none; background-color: white" role="navigation">
    <div class="container" style="max-width: 960px;">
	    <div class="navbar-header">
	        <button type="button" class="navbar-toggle visible-xs" style="width: 44px;" data-toggle="offcanvas">
                <span class="glyphicon glyphicon-search"></span>
            </button>
            <h4>
            {% if search %}
                {% if length == 1 %}
                    Found {{ length }} result for "{{ search }}" in {{ time }} seconds
                {% elif length > 1 %}
                    Found {{ length }} results for "{{ search }}" in {{ time }} seconds
                {% else %}
                    Found {{ length }} results for "{{ search }}"
                {% endif %}
            {% else %}
                {% if length == 1 %}
                    Found {{ length }} result for selected filters in {{ time }} seconds
                {% elif length > 1 %}
                    Found {{ length }} results for selected filters in {{ time }} seconds
                {% else %}
                    Found {{ length }} results for selected filters
                {% endif %}
            {% endif %}
            </h4>
            <h5>
            {% if length > 0 %}
    		    Page <strong>{{ page_num }}</strong> : Displaying records <strong>{{start+1}} - 
    		        {% if length < num_results %} 
    		            {{ length }}
                    {% elif (length - start) < num_results %}
                        {{ length }}
                    {% else %} 
                        {{ start + num_results }}
                    {% endif %}
                    </strong>
            {% else %}
                No records to display
            {% endif %}
            </h5>
	    </div>
    </div>
</div>

<div class="container" style="max-width: 960px;">
  
    <div class="row row-offcanvas row-offcanvas-right" style="margin-bottom: 50px;">
        <div class="col-xs-12 col-sm-8">
            
            <div class="row">
                {% if length %}
            	{% set count = start + 1 %}
                {% for result in results %}
                <div class="col-6">
                    <div class="panel panel-result">
                        {% if not list_view %}
                        <div class="panel-heading">
                            <h3 class="panel-title">{{ count }}. {{ result.title }}</h3>
                        </div>
                        <div class="panel-body">
                            <h5><b>{{ result.agency }}</b></h5>
                            <h5>{{ result.category }}</h5>
                            <p>
                                <small>{{ result.date_created }}</small>
                                <small style="padding-left: 2em">{{ result.type }}</small>
                            </p>
                            <p> {{ result.description }} </p>
                            <p>
                                {% if result.url != '' %}
                                <form method="get" action="{{ url_for('publication',id = result.id,title=result.title) }}" style="display: inline-block;">
                                    <button type="submit" class="btn btn-sm btn-nyc">
                                        <span class="glyphicon glyphicon-eye-open"></span> View
                                    </button>
                                </form>
                                <a href="{{ result.url }}" download="{{ result.filename }}" class="btn btn-sm btn-nyc">
                                    <span class="glyphicon glyphicon-save"></span> Save
                                </a>
                                {% else %}
                                <form method="get" action="404" style="display: inline-block;">
                                    <button type="submit" class="btn btn-sm btn-nyc">
                                        <span class="glyphicon glyphicon-eye-open"></span> View
                                    </button>
                                </form>
                                <form method="get" action="404" style="display: inline-block;">
                                    <button type="submit" class="btn btn-sm btn-nyc">
                                        <span class="glyphicon glyphicon-save"></span> Save
                                    </button>
                                </form>
                                {% endif %}
                            </p>
                        </div>
                        {% else %}
                        <div class="panel-heading">
                            <h3 class="panel-title">{{ count }}. <a href="{{ result.url }}">{{ result.title }}</a></h3>
                        </div>
                        <div class="panel-body">
                            <p>
                                {{ result.agency }} | {{ result.category }} | {{ result.type }} | {{ result.date_created }}
                            </p>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% set count = count + 1 %}
    			{% endfor %}
    			{% else %}
    			<div class="col-6">
    			    <div class="panel panel-default">
            			<div class="panel-heading">
                            <h3 class="panel-title">Your search did not return any results.</h3>
                        </div>
                        <div class="panel-body">
                            <p>Suggestions:
                            <ul>
                                <li>Change your filter(s)</li>
                                <li>Remove all filters</li>
                                <li>Start a new search</li>
                                <li>Simplify your search</li>
                                <li>Check your spelling</li>
                            </ul>
                            </p>
                        </div>
    			    </div>
    			</div>
    			{% endif %}
    			<div class="text-center">
        			{{ pagination.links|safe }}
    			</div>
            </div>
        </div>
        <div class="col-xs-6 col-sm-4 sidebar-offcanvas">
            <div id="options" style="position: fixed; overflow-y: scroll; top: 0; bottom: 0; padding-top: 151px; margin-bottom: 51px;">
                <form id="result-form" class="form-search" role="form" method="post" action = '/results'>
        			<div class="input-group" style="width: 260px;">
        				<input type="text" id="input_text" class="form-control" name="user_input" placeholder="Enter Search">
        				<span class="input-group-btn">
        					<button type="submit" class="btn btn-nyc" id="btn" name="btn" value="Refine / Search" onclick="$.jStorage.set('scrollPosition', 0);">Search</button>
        				</span>
        			</div>
        			<br>
        			<input type="checkbox" class="popover-hover-right" name="fulltext" data-toggle="popover" data-content="Checking this option will enable searching within entire document texts."> Enable Full-Text Searching
        			<br><br>
        			<div id="selects">
                        <select name="agency[]" id="agencies" class="selectpicker input-medium" multiple data-live-search="true" style="display: none;">
                            <option value="Aging" >Aging</option>
                            <option value="Buildings" >Buildings</option>
                            <option value="Campaign Finance" >Campaign Finance</option>
                            <option value="Children's Services" >Children's Services</option>
                            <option value="City Council" >City Council</option>
                            <option value="City Clerk" >City Clerk</option>
                            <option value="City Planning" >City Planning</option>
                            <option value="Citywide Admin Svcs" >Citywide Admin Svcs</option>
                            <option value="Civilian Complaint" >Civilian Complaint</option>
                            <option value="Comm - Police Corr" >Comm - Police Corr</option>
                            <option value="Community Assistance" >Community Assistance</option>
                            <option value="Comptroller" >Comptroller</option>
                            <option value="Conflicts of Interest" >Conflicts of Interest</option>
                            <option value="Consumer Affairs" >Consumer Affairs</option>
                            <option value="Contracts" >Contracts</option>
                            <option value="Correction" >Correction</option>
                            <option value="Criminal Justice Coordinator" >Criminal Justice Coordinator</option>
                            <option value="Cultural Affairs" >Cultural Affairs</option>
                            <option value="DOI - Investigation" >DOI - Investigation</option>
                            <option value="Design/Construction" >Design/Construction</option>
                            <option value="Disabilities" >Disabilities</option>
                            <option value="District Atty, NY County" >District Atty, NY County</option>
                            <option value="Districting Commiss" >Districting Commiss</option>
                            <option value="Domestic Violence" >Domestic Violence</option>
                            <option value="Economic Development" >Economic Development</option>
                            <option value="Education, Dept. of" >Education, Dept. of</option>
                            <option value="Elections, Board of" >Elections, Board of</option>
                            <option value="Emergency Mgmt." >Emergency Mgmt.</option>
                            <option value="Employment" >Employment</option>
                            <option value="Empowerment Zone" >Empowerment Zone</option>
                            <option value="Environmental - DEP" >Environmental - DEP</option>
                            <option value="Environmental - OEC" >Environmental - OEC</option>
                            <option value="Environmental - ECB" >Environmental - ECB</option>
                            <option value="Equal Employment" >Equal Employment</option>
                            <option value="Film/Theatre" >Film/Theatre</option>
                            <option value="Finance" >Finance</option>
                            <option value="Fire" >Fire</option>
                            <option value="FISA" >FISA</option>
                            <option value="Health and Mental Hyg." >Health and Mental Hyg.</option>
                            <option value="HealthStat" >HealthStat</option>
                            <option value="Homeless Services" >Homeless Services</option>
                            <option value="Hospitals - HHC" >Hospitals - HHC</option>
                            <option value="Housing - HPD" >Housing - HPD</option>
                            <option value="Human Rights" >Human Rights</option>
                            <option value="Human Rsrcs - HRA" >Human Rsrcs - HRA</option>
                            <option value="Immigrant Affairs" >Immigrant Affairs</option>
                            <option value="Independent Budget" >Independent Budget</option>
                            <option value="Info. Tech. and Telecom." >Info. Tech. and Telecom.</option>
                            <option value="Intergovernmental" >Intergovernmental</option>
                            <option value="International Affairs" >International Affairs</option>
                            <option value="Judiciary Committee" >Judiciary Committee</option>
                            <option value="Juvenile Justice" >Juvenile Justice</option>
                            <option value="Labor Relations" >Labor Relations</option>
                            <option value="Landmarks" >Landmarks</option>
                            <option value="Law Department" >Law Department</option>
                            <option value="Library - Brooklyn" >Library - Brooklyn</option>
                            <option value="Library - New York" >Library - New York</option>
                            <option value="Library - Queens" >Library - Queens</option>
                            <option value="Loft Board" >Loft Board</option>
                            <option value="Management and Budget" >Management and Budget</option>
                            <option value="Mayor" >Mayor</option>
                            <option value="Metropolitan Transportation Authority" >MTA</option>
                            <option value="NYCERS" >NYCERS</option>
                            <option value="Operations" >Operations</option>
                            <option value="Parks and Recreation" >Parks and Recreation</option>
                            <option value="Payroll Administration" >Payroll Administration</option>
                            <option value="Police" >Police</option>
                            <option value="Police Pension Fund" >Police Pension Fund</option>
                            <option value="Probation" >Probation</option>
                            <option value="Public Advocate" >Public Advocate</option>
                            <option value="Public Health" >Public Health</option>
                            <option value="Public Housing-NYCHA" >Public Housing-NYCHA</option>
                            <option value="Records" >Records</option>
                            <option value="Rent Guidelines" >Rent Guidelines</option>
                            <option value="Sanitation" >Sanitation</option>
                            <option value="School Construction" >School Construction</option>
                            <option value="Small Business Svcs" >Small Business Svcs</option>
                            <option value="Sports Commission" >Sports Commission</option>
                            <option value="Standards and Appeal" >Standards and Appeal</option>
                            <option value="Tax Appeals Tribunal" >Tax Appeals Tribunal</option>
                            <option value="Tax Commission" >Tax Commission</option>
                            <option value="Taxi and Limousine" >Taxi and Limousine</option>
                            <option value="Transportation" >Transportation</option>
                            <option value="Trials and Hearings" >Trials and Hearings</option>
                            <option value="Veterans - Military" >Veterans - Military</option>
                            <option value="Volunteer Center" >Volunteer Center</option>
                            <option value="Voter Assistance" >Voter Assistance</option>
                            <option value="Youth & Community" >Youth & Community</option>
                        </select>
                        <br><br>
                        <select name="category[]" id="categories" class="selectpicker" multiple data-live-search="true" style="display: none;">
                            <option value="Business and Consumers">Business and Consumers</option>
                            <option value="Cultural/Entertainment">Cultural/Entertainment</option>
                            <option value="Education">Education</option>
                            <option value="Environment">Environment</option>
                            <option value="Finance and Budget">Finance and Budget</option>
                            <option value="Government Policy">Government Policy</option>
                            <option value="Health">Health</option>
                            <option value="Housing and Buildings">Housing and Buildings</option>
                            <option value="Human Services">Human Services</option>
                            <option value="Labor Relations">Labor Relations</option>
                            <option value="Public Safety">Public Safety</option>
                            <option value="Recreation/Parks">Recreation/Parks</option>
                            <option value="Sanitation">Sanitation</option>
                            <option value="Technology">Technology</option>
                            <option value="Transportation">Transportation</option>
                        </select>
                        <br><br>
                        <select name="type[]" id="types" onfocus="skipcycle=true" onblur="skipcycle=false" class="selectpicker" multiple data-live-search="true" style="display: none;">
                            <option value="Annual Report">Annual Report</option>
                            <option value="Audit Report">Audit Report</option>
                            <option value="Bond Offering - Offical Statements">Bond Offering</option>
                            <option value="Budget Report">Budget Report</option>
                            <option value="Consultant Report">Consultant Report</option>
                            <option value="Guide - Manual">Guide - Manual</option>
                            <option value="Hearing - Minutes">Hearing - Minutes</option>
                            <option value="Legislative Document">Legislative Document</option>
                            <option value="Memoranda - Directive">Memoranda - Directive</option>
                            <option value="Press Release">Press Release</option>
                            <option value="Serial Publication">Serial Publication</option>
                            <option value="Staff Report">Staff Report</option>
                            <option value="Report">Report</option>
                        </select>
                    </div>
                    <br>
                    <div class="btn-group btn-group-justified" style="width: 260px;">
                        <div class="btn-group">
                            <button type="submit" class="btn btn-nyc" id="btn" name="btn" value="Refine / Search" onclick="$.jStorage.set('scrollPosition', 0);">Filter</button>
                        </div>
                        <div class="btn-group">                        
                            <button type="button" class="btn btn-coral" id="btn" value="Remove All">Remove Filters</button>
                        </div>
                    </div>
                </form>
                <br>
                <div class="btn-group btn-group-justified" style="width: 260px;">
                    <div class="btn-group">
                        <button type="button" class="btn btn-default disabled">Sort By </button>
                    </div>
                    <div class="btn-group dropup">
                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                            {{ sort_method + ' ' }}<span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu" onclick="$.jStorage.set('scrollPosition', 0);">
                            <li><a href="{{ url_for('results', sort='Relevance') }}" >Relevance</a></li>
                            <li class="divider"></li>
                            <p style="padding-left: 10px; font-weight: bold;">Date</p>
                            <li><a href="{{ url_for('results', sort='Date: Newest') }}">Newest</a></li>
                            <li><a href="{{ url_for('results', sort='Date: Oldest') }}">Oldest</a></li>
                            <li class="divider"></li>
                            <p style="padding-left: 10px; font-weight: bold;">Title</p>
                            <li><a href="{{ url_for('results', sort='Title: A - Z') }}">A - Z</a></li>
                            <li><a href="{{ url_for('results', sort='Title: Z - A') }}">Z - A</a></li>
                            <li class="divider"></li>
                            <p style="padding-left: 10px; font-weight: bold;">Agency</p>
                            <li><a href="{{ url_for('results', sort='Agency: A - Z') }}">A - Z</a></li>
                            <li><a href="{{ url_for('results', sort='Agency: Z - A') }}">Z - A</a></li>
                        </ul>
                    </div>
                </div>
                <br>
                <div class="btn-group btn-group-justified" style="width: 260px;">
                    <div class="btn-group">
                        <button type="button" class="btn btn-default disabled">Results Per Page</button>
                    </div>
                    <div class="btn-group dropup">
                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                        	{{ num_results }} <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu" onclick="$.jStorage.set('scrollPosition', 0);">
                            <li><a href="{{ url_for('results', num_results=10) }}">10</a></li>
                            <li><a href="{{ url_for('results', num_results=20) }}">20</a></li>
                            <li><a href="{{ url_for('results', num_results=50) }}">50</a></li>
                        	<li><a href="{{ url_for('results', num_results=100) }}">100</a></li>
                        </ul>
                    </div>
                </div>
                <br>
                <div class="btn-group btn-group-justified" style="width: 260px;">
        			<a type="button" {% if list_view %} class="btn btn-default navbar-btn" {% else %} class="btn btn-default navbar-btn disabled" {% endif %} href="{{ url_for('results', list_view=0) }}">
        				<span class="glyphicon glyphicon-th-list"></span> 
        			</a>
        			<a type="button" {% if not list_view %} class="btn btn-default navbar-btn" {% else %} class="btn btn-default navbar-btn disabled" {% endif %} href="{{ url_for('results', list_view=1) }}">
        				<span class="glyphicon glyphicon-list"></span>
        			</a>
        		</div>
        		<br>
        		<div id="2top" style="display: none;" onclick="$('body').animate({ scrollTop: 0 }, 'slow');">
            		<button type="button" class="btn btn-default">
                        <span class="glyphicon glyphicon-arrow-up"></span> Return To Top
                    </button>
        		</div>
            </div>
        </div>
    </div>
</div>

{% endblock %}